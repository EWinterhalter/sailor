{
  "timestamp": "2025-12-10T10:51:00.744132542+03:00",
  "scan": {
    "image": "bad_container",
    "container_id": "2580cc5c015a",
    "total_time_ms": 534
  },
  "results": {
    "summary": {
      "total_checks": 6,
      "passed": 2,
      "warnings": 1,
      "failed": 3,
      "critical": 0,
      "high": 3,
      "medium": 1,
      "low": 2,
      "has_failures": true,
      "has_warnings": true
    },
    "checks": [
      {
        "name": "Open Ports",
        "description": "Checking for exposed network ports",
        "severity": "low",
        "status": "pass",
        "duration_ms": 60,
        "output_full": null,
        "issues": []
      },
      {
        "name": "Network Connections",
        "description": "Checking active network connections",
        "severity": "low",
        "status": "pass",
        "duration_ms": 49,
        "output_full": null,
        "issues": []
      },
      {
        "name": "Environment",
        "description": "Checking for sensitive data in environment",
        "severity": "high",
        "status": "fail",
        "duration_ms": 46,
        "output": "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nHOSTNAME=2580cc5c015a\nDB_PASSWORD=supersecret123\nAPI_KEY=123456789\nHOME=/root\n",
        "output_full": null,
        "issues": [
          "Sensitive data exposed: DB_PASSWORD, DB_PASSWORD, DB_PASSWORD, API_KEY"
        ]
      },
      {
        "name": "Root User",
        "description": "Checks if container runs as root",
        "severity": "high",
        "status": "fail",
        "duration_ms": 47,
        "output": "0\n",
        "output_full": null,
        "issues": [
          "Container runs as root (UID=0)"
        ]
      },
      {
        "name": "Image History",
        "description": "Check layers for secrets or sensitive files",
        "severity": "high",
        "status": "fail",
        "duration_ms": 29,
        "output_preview": "/bin/sh -c #(nop)  CMD [\"sh\" \"-c\" \"echo 'Этот контейнер УМЫШЛЕННО небезопасен ^_^'\"]\n/bin/sh -c #(nop)  EXPOSE 8080\n/bin/sh -c #(nop)  USER root\n/bin/sh -c #(nop)  ENV DB_PASSWORD=supersecret123 API_KEY=123456789\n/bin/sh -c apk add --no-cache bash\n/bin/sh -c #(nop)  ...",
        "output_full": null,
        "issues": [
          "Secrets found in image history: PASSWORD, SECRET, API_KEY"
        ]
      },
      {
        "name": "Writable FS",
        "description": "Checks if writing to root filesystem is possible",
        "severity": "medium",
        "status": "warn",
        "duration_ms": 47,
        "output": "OK\n",
        "output_full": null,
        "issues": [
          "Root filesystem is writable"
        ]
      }
    ]
  }
}